<!DOCTYPE html>
<html>
<head>
    <style>
        body { font-family: sans-serif; display: flex; justify-content: center; padding: 50px; background: #f4f7f6; }
        form { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); width: 300px; }
        input, textarea { width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
        button { width: 100%; padding: 10px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #218838; }
    </style>
</head>
<body>
    <form id="msgForm">
        <h3>Send a Message</h3>
        <!-- The 'name' attribute here MUST match the script -->
        <input name="name" id="nameInput" placeholder="Your Name" required>
        <textarea name="message" id="messageInput" placeholder="Your Message" rows="4" required></textarea>
        <button type="submit" id="submitBtn">Send to Sheet</button>
    </form>

    <script>
        const URL = 'https://script.google.com/macros/s/AKfycbzV1Q8a_KXJcBQuwYUPwoGoyYcQerYAvJJswX9Bm3oFyNeJzfGxjCr_J1OH4swa31LZ/exec';
        
        document.getElementById('msgForm').onsubmit = function(e) {
            e.preventDefault();
            const btn = document.getElementById('submitBtn');
            btn.innerText = 'Sending...';
            btn.disabled = true;

            // Create the data string
            const name = document.getElementById('nameInput').value;
            const message = document.getElementById('messageInput').value;
            
            // We use a simple fetch with URLSearchParams which GAS loves
            fetch(URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                body: new URLSearchParams({
                    'name': name,
                    'message': message
                })
            })
            .then(() => {
                alert("Sent successfully!");
                document.getElementById('msgForm').reset();
            })
            .catch(err => {
                alert("Error: " + err.message);
            })
            .finally(() => {
                btn.innerText = 'Send to Sheet';
                btn.disabled = false;
            });
        };
    </script>
</body>
</html>
